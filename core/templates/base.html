{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>{% block title %}Agrícola Rural{% endblock %}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
  <link rel="stylesheet" href="{% static 'css/navbar.css' %}">
   <style> 
     html, body {
      height: 100%;
      margin: 0;
    }
    body {
      min-height: 100vh;
      overflow: hidden;
      background: #f8f9fa;
    }
    body.no-aside .layout-content {
      left: 0 !important;
      padding-left: 0.5rem;
      padding-right: 0.5rem;
    }

    .layout-navbar {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 1040;
      height: 64px;
      background: #fff;
      box-shadow: 0 1px 8px rgba(0,0,0,0.04);
      display: flex;
      align-items: center;
    }
    .layout-aside {
      position: fixed;
      top: 64px;
      left: 0;
      bottom: 48px;
      width: 240px;
      background: #fff;
      box-shadow: 1px 0 8px rgba(0,0,0,0.04);
      z-index: 1030;
      padding-top: 1.5rem;
      overflow-y: auto;
    }
    .layout-footer {
      position: fixed;
      left: 0;
      right: 0;
      bottom: 0;
      height: 48px;
      background: #fff;
      border-top: 1px solid #dee2e6;
      z-index: 1040;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.92rem;
      color: #6c757d;
    }
    .layout-content {
      position: absolute;
      left: 240px;
      right: 0;
      top: 64px;
      bottom: 48px;
      overflow-y: auto;
      padding: 2rem 2rem 1.5rem 2rem;
      background: #f8f9fa;
    }
    @media (max-width: 991px) {
      .layout-aside {
        width: 65px;
        padding-top: 0.5rem;
      }
      .layout-content {
        left: 65px;
        padding-left: 1rem;
        padding-right: 1rem;
      }
    } 
  </style>

  <link rel="stylesheet" href="{% static 'css/base.css' %}">
  {% block extra_head %}{% endblock %}
</head>

<body class="{% block body_class %}{% endblock %}">


  <!-- NAVBAR -->

  <div class="container school-navbar d-flex align-items-center justify-content-between rounded-pill mt-4">
  
  <!-- Logo + nombre -->
  <div class="d-flex align-items-center">
    <a href="{% url 'bienvenida' %}" class="navbar-brand fw-bold fs-4 mb-0 text-white d-flex align-items-center">
      <img src="{% static 'img/logo1.svg' %}" alt="logo avatar" style="width: 90px;" class="rounded-pill me-2">
      <span class="navbar-title">Agricola Rural</span>
    </a>
  </div>

  <!-- Menú centrado -->
  <ul class="nav school-nav mx-auto">
    <li class="nav-item">
      <a class="nav-link {% if request.path == '/nosotros/' %}active{% endif %}" href="#nosotros">Nosotros</a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="#cultura">Cultura</a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="#bienestar">Bienestar</a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="#mision">Misión y Visión</a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="#valores">Valores</a>
    </li>
  </ul>

  <!-- Botones -->
  <div class="d-flex align-items-center">
    {% if user.is_authenticated %}
      <div class="dropdown">
        <button class="btn btn-light rounded-pill px-3 d-flex align-items-center gap-2 school-navbar-user-btn" data-bs-toggle="dropdown" aria-expanded="false">
          {% if user.perfil.foto %}
            <img src="{{ user.perfil.foto.url }}" class="rounded-circle me-2" width="36" height="36" style="object-fit:cover;">
          {% else %}
            <img src="{% static 'img/default_avatar.png' %}" class="rounded-circle me-2" width="36" height="36">
          {% endif %}
          <span class="fw-semibold text-success">Bienvenido, {{ user.perfil.primer_nombre }}</span>
        </button>
        <ul class="dropdown-menu dropdown-menu-end mt-2">
          <li><a class="dropdown-item" href="{% url 'perfil_usuario' %}"><i class="bi bi-person-circle me-2"></i>Perfil de Usuario</a></li>
          <li><a class="dropdown-item" href="{% url 'editar_perfil' %}"><i class="bi bi-pencil-square me-2"></i>Editar Perfil</a></li>
          <li><hr class="dropdown-divider"></li>
          <li>
            <form method="post" action="{% url 'logout' %}">
              {% csrf_token %}
              <button type="submit" class="dropdown-item text-danger">
                <i class="bi bi-box-arrow-right me-2"></i>Cerrar sesión
              </button>
            </form>
          </li>
        </ul>
      </div>
    {% else %}
      <a href="{% url 'login' %}" class="school-navbar-login-btn me-2">iniciar sesion</a>
      <a href="{% url 'registro' %}" class="school-navbar-register-btn">Registrarse</a>
    {% endif %}
  </div>
</div>

<link rel="stylesheet" href="{% static 'css/navbar.css' %}">
<script src="{% static 'js/scroll.js' %}"></script>




  <!-- ASIDE (menú lateral) -->
  {% if user.is_authenticated %}
    <aside class="layout-aside">
      {% block aside %}
        {% if user.rol.nombre == "Coordinador Académico" %}
          {% include "includes/aside_coordinador.html" %}
        {% elif user.rol.nombre == "Docente" %}
          {% include "includes/aside_docente.html" %}
        {% endif %}
      {% endblock %}
    </aside>
  {% endif %}

  <!-- CONTENIDO CENTRAL -->

    {% block content %}{% endblock %}


  <!-- FOOTER FIJO -->
  <footer class="text-center py-3 text-white" style="background-color: #2e7d32;">
    © 2025 Sistema Escolar. Todos los derechos reservados. | Contacto: colegio@example.edu.co
  </footer>

  <script src="{% static 'js/scroll.js' %}"></script>
  <script src="{% static 'js/bootstrap.bundle.min.js' %}"></script>


  {% block extra_js %}{% endblock %}
</body>
</html>
